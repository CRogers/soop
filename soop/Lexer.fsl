{

module Lexer

open Parser

let lineno = ref 1

let kwtable = Map([
    ("class", CLASS); ("{", LCURLY); ("{", RCURLY); ("(", LPAR); (")", RPAR);
    ("if", IF); ("else", ELSE); ("for", FOR); ("while", WHILE); ("in", IN); (";", SEMI)
    ])

}

let ident = ['a'-'z' 'A'-'Z']*
let white = [' ' '\t']
let newline = '\r'? '\n'

rule token = parse
    | white+               { token lexbuf }
    | newline              { incr lineno }